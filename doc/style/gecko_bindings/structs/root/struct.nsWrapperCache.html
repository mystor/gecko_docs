<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <meta name="description" content="API documentation for the Rust `nsWrapperCache` struct in crate `style`.">
    <meta name="keywords" content="rust, rustlang, rust-lang, nsWrapperCache">

    <title>style::gecko_bindings::structs::root::nsWrapperCache - Rust</title>

    <link rel="stylesheet" type="text/css" href="../../../../normalize.css">
    <link rel="stylesheet" type="text/css" href="../../../../rustdoc.css">
    <link rel="stylesheet" type="text/css" href="../../../../main.css">
    

    
    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    

    <nav class="sidebar">
        
        <p class='location'><a href='../../../index.html'>style</a>::<wbr><a href='../../index.html'>gecko_bindings</a>::<wbr><a href='../index.html'>structs</a>::<wbr><a href='index.html'>root</a></p><script>window.sidebarCurrent = {name: 'nsWrapperCache', ty: 'struct', relpath: ''};</script><script defer src="sidebar-items.js"></script>
    </nav>

    <nav class="sub">
        <form class="search-form js-only">
            <div class="search-container">
                <input class="search-input" name="search"
                       autocomplete="off"
                       placeholder="Click or press ‘S’ to search, ‘?’ for more options…"
                       type="search">
            </div>
        </form>
    </nav>

    <section id='main' class="content struct">
<h1 class='fqn'><span class='in-band'>Struct <a href='../../../index.html'>style</a>::<wbr><a href='../../index.html'>gecko_bindings</a>::<wbr><a href='../index.html'>structs</a>::<wbr><a href='index.html'>root</a>::<wbr><a class='struct' href=''>nsWrapperCache</a></span><span class='out-of-band'><span id='render-detail'>
                   <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">
                       [<span class='inner'>&#x2212;</span>]
                   </a>
               </span><a class='srclink' href='../../../../src/style/home/mlayzell/Code/gecko_rustdoc/debug/build/style-e21a99fb60ed644f/out/gecko/structs_debug.rs.html#7728-7732' title='goto source code'>[src]</a></span></h1>
<pre class='rust struct'><div class="docblock attributes">#[repr(C)]
</div>pub struct nsWrapperCache {
    pub vtable_: <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.pointer.html'>*const </a><a class='struct' href='../../../../style/gecko_bindings/structs/root/struct.nsWrapperCache__bindgen_vtable.html' title='style::gecko_bindings::structs::root::nsWrapperCache__bindgen_vtable'>nsWrapperCache__bindgen_vtable</a>,
    pub mWrapper: <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.pointer.html'>*mut </a><a class='struct' href='../../../../style/gecko_bindings/structs/root/struct.JSObject.html' title='style::gecko_bindings::structs::root::JSObject'>JSObject</a>,
    pub mFlags: <a class='type' href='../../../../style/gecko_bindings/structs/root/type.nsWrapperCache_FlagsType.html' title='style::gecko_bindings::structs::root::nsWrapperCache_FlagsType'>nsWrapperCache_FlagsType</a>,
}</pre><div class='docblock'><p>Class to store the wrapper for an object. This can only be used with objects
that only have one non-security wrapper at a time (for an XPCWrappedNative
this is usually ensured by setting an explicit parent in the PreCreate hook
for the class).</p>

<p>An instance of nsWrapperCache can be gotten from an object that implements
a wrapper cache by calling QueryInterface on it. Note that this breaks XPCOM
rules a bit (this object doesn&#39;t derive from nsISupports).</p>

<p>The cache can store objects other than wrappers. We allow wrappers to use a
separate JSObject to store their state (mostly expandos). If the wrapper is
collected and we want to preserve this state we actually store the state
object in the cache.</p>

<p>The cache can store 2 types of objects:</p>

<p>If WRAPPER_IS_NOT_DOM_BINDING is set (IsDOMBinding() returns false):
   - the JSObject of an XPCWrappedNative wrapper</p>

<p>If WRAPPER_IS_NOT_DOM_BINDING is not set (IsDOMBinding() returns true):
   - a DOM binding object (regular JS object or proxy)</p>

<p>The finalizer for the wrapper clears the cache.</p>

<p>A compacting GC can move the wrapper object. Pointers to moved objects are
usually found and updated by tracing the heap, however non-preserved wrappers
are weak references and are not traced, so another approach is
necessary. Instead a class hook (objectMovedOp) is provided that is called
when an object is moved and is responsible for ensuring pointers are
updated. It does this by calling UpdateWrapper() on the wrapper
cache. SetWrapper() asserts that the hook is implemented for any wrapper set.</p>

<p>A number of the methods are implemented in nsWrapperCacheInlines.h because we
have to include some JS headers that don&#39;t play nicely with the rest of the
codebase. Include nsWrapperCacheInlines.h if you need to call those methods.</p>
</div><h2 class='fields'>Fields</h2><span id='structfield.vtable_' class='structfield'>
                           <span id='vtable_.v' class='invisible'>
                           <code>vtable_: <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.pointer.html'>*const </a><a class='struct' href='../../../../style/gecko_bindings/structs/root/struct.nsWrapperCache__bindgen_vtable.html' title='style::gecko_bindings::structs::root::nsWrapperCache__bindgen_vtable'>nsWrapperCache__bindgen_vtable</a></code>
                           </span></span><span class='stab '></span><span id='structfield.mWrapper' class='structfield'>
                           <span id='mWrapper.v' class='invisible'>
                           <code>mWrapper: <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.pointer.html'>*mut </a><a class='struct' href='../../../../style/gecko_bindings/structs/root/struct.JSObject.html' title='style::gecko_bindings::structs::root::JSObject'>JSObject</a></code>
                           </span></span><span class='stab '></span><span id='structfield.mFlags' class='structfield'>
                           <span id='mFlags.v' class='invisible'>
                           <code>mFlags: <a class='type' href='../../../../style/gecko_bindings/structs/root/type.nsWrapperCache_FlagsType.html' title='style::gecko_bindings::structs::root::nsWrapperCache_FlagsType'>nsWrapperCache_FlagsType</a></code>
                           </span></span><span class='stab '></span><h2 id='implementations'>Trait Implementations</h2><h3 class='impl'><span class='in-band'><code>impl <a class='trait' href='https://doc.rust-lang.org/nightly/core/fmt/trait.Debug.html' title='core::fmt::Debug'>Debug</a> for <a class='struct' href='../../../../style/gecko_bindings/structs/root/struct.nsWrapperCache.html' title='style::gecko_bindings::structs::root::nsWrapperCache'>nsWrapperCache</a></code></span><span class='out-of-band'><div class='ghost'></div><a class='srclink' href='../../../../src/style/home/mlayzell/Code/gecko_rustdoc/debug/build/style-e21a99fb60ed644f/out/gecko/structs_debug.rs.html#7727' title='goto source code'>[src]</a></span></h3>
<div class='impl-items'><h4 id='method.fmt' class='method'><span id='fmt.v' class='invisible'><code>fn <a href='https://doc.rust-lang.org/nightly/core/fmt/trait.Debug.html#tymethod.fmt' class='fnname'>fmt</a>(&amp;self, __arg_0: &amp;mut <a class='struct' href='https://doc.rust-lang.org/nightly/core/fmt/struct.Formatter.html' title='core::fmt::Formatter'>Formatter</a>) -&gt; <a class='type' href='https://doc.rust-lang.org/nightly/core/fmt/type.Result.html' title='core::fmt::Result'>Result</a></code></span></h4>
<div class='docblock'><p>Formats the value using the given formatter.</p>
</div></div></section>
    <section id='search' class="content hidden"></section>

    <section class="footer"></section>

    <aside id="help" class="hidden">
        <div>
            <h1 class="hidden">Help</h1>

            <div class="shortcuts">
                <h2>Keyboard Shortcuts</h2>

                <dl>
                    <dt>?</dt>
                    <dd>Show this help dialog</dd>
                    <dt>S</dt>
                    <dd>Focus the search field</dd>
                    <dt>&larrb;</dt>
                    <dd>Move up in search results</dd>
                    <dt>&rarrb;</dt>
                    <dd>Move down in search results</dd>
                    <dt>&#9166;</dt>
                    <dd>Go to active search result</dd>
                    <dt>+</dt>
                    <dd>Collapse/expand all sections</dd>
                </dl>
            </div>

            <div class="infos">
                <h2>Search Tricks</h2>

                <p>
                    Prefix searches with a type followed by a colon (e.g.
                    <code>fn:</code>) to restrict the search to a given type.
                </p>

                <p>
                    Accepted types are: <code>fn</code>, <code>mod</code>,
                    <code>struct</code>, <code>enum</code>,
                    <code>trait</code>, <code>type</code>, <code>macro</code>,
                    and <code>const</code>.
                </p>

                <p>
                    Search functions by type signature (e.g.
                    <code>vec -> usize</code> or <code>* -> vec</code>)
                </p>
            </div>
        </div>
    </aside>

    

    <script>
        window.rootPath = "../../../../";
        window.currentCrate = "style";
    </script>
    <script src="../../../../jquery.js"></script>
    <script src="../../../../main.js"></script>
    <script defer src="../../../../search-index.js"></script>
</body>
</html>